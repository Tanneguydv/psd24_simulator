<?xml version="1.0" ?>
<robot name="psd_vehicle" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <!-- include materials -->
  <xacro:include filename="$(find psd_vehicle_description)/urdf/materials.xacro" />
  
  <!-- start vehicle description -->
  <xacro:macro name="psd_vehicle" params="parent *origin">

    <xacro:property name="PI" value="3.14159265359" />
    <xacro:property name="rot90" value="${90 * PI / 180}" />
    <xacro:property name="max_steering_angle" value="${20 * PI / 180}" />
    <!-- LINKS -->

    <!-- Chassis START-->  
    <link name="chassis">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="10.0"/>
        <inertia ixx="0.354236" iyy="0.082009" izz="0.401568" ixy="0.0" iyz="0.0" ixz="0.0"/>
      </inertial>
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/chassis.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="anodized_red"/>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/stl/chassis.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <!-- FRONT -->
    <joint name="world_joint" type="fixed">
      <xacro:insert_block name="origin" />
      <parent link="${parent}" />
      <child link="chassis" />
    </joint>

    <link name="link_FL">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="0.270"/>
        <inertia ixx="0.000189" iyy="0.000409" izz="0.000593" ixy="0.0" iyz="0.0" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/suspension.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="anodized_blue"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/suspension.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="link_FR">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="0.270"/>
        <inertia ixx="0.000189" iyy="0.000409" izz="0.000593" ixy="0.0" iyz="0.0" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/suspension.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="anodized_blue"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/suspension.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="steering_hinge_FL">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="0.155"/>
        <inertia ixx="0.0" iyy="0.0" izz="0.0" ixy="-0.0" iyz="0.0" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/steering_hinge.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="silver"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/steering_hinge.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="steering_hinge_FR">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="0.155"/>
        <inertia ixx="0.0" iyy="0.0" izz="0.0" ixy="-0.0" iyz="0.0" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/steering_hinge.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="silver"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/steering_hinge.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="wheel_FL">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="2.80"/>
        <inertia ixx="0.007152" iyy="0.005137" izz="0.005138" ixy="0.0" iyz="1e-06" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/wheel.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="rubber_tyre"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/wheel.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="wheel_FR">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="2.80"/>
        <inertia ixx="0.007152" iyy="0.005137" izz="0.005138" ixy="0.0" iyz="1e-06" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/wheel.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="rubber_tyre"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/wheel.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="tyre_FL">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="4.40"/>
        <inertia ixx="0.029818" iyy="0.017591" izz="0.017591" ixy="-0.0" iyz="0.0" ixz="0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/tyre.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="rubber_tyre"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/tyre.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="tyre_FR">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="4.40"/>
        <inertia ixx="0.029818" iyy="0.017591" izz="0.017591" ixy="-0.0" iyz="0.0" ixz="0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/tyre.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="rubber_tyre"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/tyre.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <!-- REAR -->
    <link name="link_RL">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="0.270"/>
        <inertia ixx="0.000189" iyy="0.000409" izz="0.000593" ixy="0.0" iyz="0.0" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/suspension.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="anodized_blue"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/suspension.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="link_RR">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="0.270"/>
        <inertia ixx="0.000189" iyy="0.000409" izz="0.000593" ixy="0.0" iyz="0.0" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/suspension.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="anodized_blue"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/suspension.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="wheel_RL">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="2.80"/>
        <inertia ixx="0.007152" iyy="0.005137" izz="0.005138" ixy="0.0" iyz="1e-06" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/wheel.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="rubber_tyre"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/wheel.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="wheel_RR">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="2.80"/>
        <inertia ixx="0.007152" iyy="0.005137" izz="0.005138" ixy="0.0" iyz="1e-06" ixz="-0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/wheel.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="rubber_tyre"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/wheel.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="tyre_RL">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="4.40"/>
        <inertia ixx="0.029818" iyy="0.017591" izz="0.017591" ixy="-0.0" iyz="0.0" ixz="0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/tyre.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="rubber_tyre"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/tyre.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <link name="tyre_RR">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <mass value="4.40"/>
        <inertia ixx="0.029818" iyy="0.017591" izz="0.017591" ixy="-0.0" iyz="0.0" ixz="0.0"/>
      </inertial>
      <visual>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/tyre.stl" scale="0.001 0.001 0.001"/>
        </geometry>
        <material name="rubber_tyre"/>
      </visual>
      <collision>
        <origin xyz="0.0 0.0 0.0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="$(find psd_vehicle_description)/meshes/stl/tyre.stl" scale="0.001 0.001 0.001"/>
        </geometry>
      </collision>
    </link>

    <!-- JOINTS -->
    <!-- SUSPENSION -->
    <joint name="suspension_FL" type="fixed">
      <origin xyz="-0.04 0.3 0.0" rpy="0 0 0"/>
      <parent link="chassis"/>
      <child link="link_FL"/>
    </joint>

    <joint name="suspension_FR" type="fixed">
      <origin xyz="0.04 0.3 0.0" rpy="0 0 0"/>
      <parent link="chassis"/>
      <child link="link_FR"/>
    </joint>

    <joint name="suspension_RL" type="fixed">
      <origin xyz="-0.04 -0.3 0.0" rpy="0 0 0"/>
      <parent link="chassis"/>
      <child link="link_RL"/>
    </joint>

    <joint name="suspension_RR" type="fixed">
      <origin xyz="0.04 -0.3 0.0" rpy="0 0 0"/>
      <parent link="chassis"/>
      <child link="link_RR"/>
    </joint>

    <!-- STEERING -->
    <joint name="steering_FL" type="revolute">
      <origin xyz="-0.175 0.3 0.0" rpy="0 ${rot90} 0"/>
      <parent link="suspension_FL"/>
      <child link="steering_hinge_FL"/>
      <axis xyz="0.0 0.0 1.0"/>
      <limit upper="${max_steering_angle}" lower="${-max_steering_angle}" effort="100" velocity="10"/>
    </joint>

    <joint name="steering_FR" type="revolute">
      <origin xyz="0.175 0.3 0.0" rpy="0 ${rot90} 0"/>
      <parent link="suspension_FR"/>
      <child link="steering_hinge_FR"/>
      <axis xyz="0.0 0.0 1.0"/>
      <limit upper="${max_steering_angle}" lower="${-max_steering_angle}" effort="100" velocity="10"/>
    </joint>

    <!-- DRIVE -->
    <joint name="drive_FL" type="continuous">
      <origin xyz="-0.001813 0.000846 0.0" rpy="0 0 0"/>
      <parent link="steering_hinge_FL"/>
      <child link="wheel_FL"/>
      <axis xyz="1.0 0.0 0.0"/>
    </joint>

    <joint name="drive_FR" type="continuous">
      <origin xyz="-0.001813 0.000846 0.0" rpy="0 0 0"/>
      <parent link="steering_hinge_FR"/>
      <child link="wheel_FR"/>
      <axis xyz="1.0 0.0 0.0"/>
    </joint>

    <joint name="drive_RL" type="continuous">
      <origin xyz="-0.001813 0.000846 0.0" rpy="0 0 0"/>
      <parent link="steering_hinge_RL"/>
      <child link="wheel_RL"/>
      <axis xyz="1.0 0.0 0.0"/>
    </joint>

    <joint name="drive_RR" type="continuous">
      <origin xyz="-0.001813 0.000846 0.0" rpy="0 0 0"/>
      <parent link="steering_hinge_RR"/>
      <child link="wheel_RR"/>
      <axis xyz="1.0 0.0 0.0"/>
    </joint>

    <!-- TYRES -->
    <joint name="tyre_attach_FL" type="fixed">
      <origin xyz="0.0 0.0 0.0" rpy="0 ${rot90} 0"/>
      <parent link="wheel_FL"/>
      <child link="tyre_FL"/>
    </joint>

    <joint name="tyre_attach_FR" type="fixed">
      <origin xyz="0.0 0.0 0.0" rpy="0 ${rot90} 0"/>
      <parent link="wheel_FR"/>
      <child link="tyre_FR"/>
    </joint>

    <joint name="tyre_attach_RL" type="fixed">
      <origin xyz="0.0 0.0 0.0" rpy="0 ${rot90} 0"/>
      <parent link="wheel_RL"/>
      <child link="tyre_RL"/>
    </joint>

    <joint name="tyre_attach_RR" type="fixed">
      <origin xyz="0.0 0.0 0.0" rpy="0 ${rot90} 0"/>
      <parent link="wheel_RR"/>
      <child link="tyre_RR"/>
    </joint>

  </xacro:macro>
</robot>